BootStrap: localimage
From: jupyter3

%help
	Container Centos 6.10 (docker)
	Glibc: 2.12-1.212.el6.x86_64
	Installed: wget, git, curl, bzip2 ca-certificates

	Run a jupyter notebook Server in a container
	Usually: http://localhost:8888
	Anaconda Python 3 (Xarray, cfgrib, eccodes)
	Eccodes and CFgrib are Software from ECMWF
	When using Virtualbox supply: --ip=0.0.0.0 to notebook
	
%test
	python -m cfgrib selfcheck
	
%post
	# Install packages and Eccodes
	/opt/conda/bin/conda install xarray bottleneck dask -y --quiet 
	/opt/conda/bin/conda install -c conda-forge -y cfgrib eccodes
	/opt/conda/bin/conda clean -a -y
	
%environment
	export PATH=/opt/conda/bin:$PATH
	# important part otherwise the server will try to access /run/user and fail
	export JUPYTER_RUNTIME_DIR=$PWD/.runtime
	# make sure we use container kernels, otherwise this will be overwritten 
	# by $HOME/.local/share/jupyter/kernels
	export JUPYTER_DATA_DIR=$PWD/.kernels